"use strict";!function(){angular.module("Album",[]).config(["$interpolateProvider",function(e){e.startSymbol("{["),e.endSymbol("]}")}])}(),function(){function e(e,n,t,o,a,i,c,r,u){var s=this;s.accountInfo={},s.getAccount=function(){e.account().then(function(e){200==e.status&&(s.accountInfo=e.data,new Date(s.accountInfo.tokenExpire)<new Date&&(s.accountInfo.accessToken=""))})},s.init=function(){s.getAccount(),n.getAlbums().then(function(e){200==e.status?s.listAlbums=e.data:a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},s.saveAlbum=function(e){if(!e)return void a.error("Kiểm tra lại dữ liệu và thử lại.","Lỗi!");s.album.photos||(s.album.photos=[]),s.tmpPhotoNames&&(s.album.photos=s.album.photos.concat(s.tmpPhotoNames)),n.saveAlbum(s.album).then(function(e){if(200==e.status){var n=[];console.log("image",s.tmpPhotos,s.tmpPhotoNames),s.tmpPhotos.map(function(t,o){var a=s.tmpPhotoNames[o];n.push(function(n){u.upload({url:apiPath+"/api/upload/image",data:{file:t,filename:a.replace(/.[^.]+$/g,""),type:"albums/"+e.data._id}}).then(function(e){console.log("success",e),n(null)},function(e){console.log("err",e),n(!0)},function(e){})})}),async.parallel(n,function(n,t){if(s.defaultPhotos(),s.album._id){for(var o in s.listAlbums)if(s.listAlbums[o]._id==s.album._id){s.listAlbums[o]=e.data;break}}else s.listAlbums||(s.listAlbums=[]),s.listAlbums.unshift(e.data);s.album=e.data,a.success("Lưu album thành công.","Thành công!")})}else a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},s.removeAlbum=function(e,t){confirm("Bạn có chắc chắn muốn xóa?")&&n.removeAlbum(e).then(function(e){200==e.status&&e.data?(a.success("Xóa album thành công.","Thành công!"),s.listAlbums.splice(t,1),s.resetAlbum()):a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},s.selectAlbum=function(e){s.album=e,s.defaultPhotos(),Common.scrollTo("#album-top","fast")},s.resetAlbum=function(){s.album={},s.defaultPhotos()},s.defaultPhotos=function(){s.tmpPhotos=[],s.tmpPhotoNames=[]},s.defaultPhotos(),s.uploadFiles=function(e,n){console.log(e,n);for(var t in e){var o=e[t];s.tmpPhotoNames.push((new Date).getTime()+"-"+o.name),s.tmpPhotos.push(o)}},s.removePhoto=function(e){s.tmpPhotos.splice(e,1),s.tmpPhotoNames.splice(e,1)},s.removeSavedPhoto=function(e){s.album.photos.splice(e,1)}}e.$inject=["UserService","AlbumService","$cookies","$rootScope","toastr","$timeout","$facebook","$http","Upload"],angular.module("Album").controller("AlbumController",e)}(),function(){function e(e){return{getAlbums:function(){return e.get(apiPath+"/api/album/getAlbums")},saveAlbum:function(n){return e.post(apiPath+"/api/album/saveAlbum",n)},removeAlbum:function(n){return e.post(apiPath+"/api/album/removeAlbum",{albumId:n})}}}e.$inject=["$http"],angular.module("Album").service("AlbumService",e)}(),function(){angular.module("Campaign",[]).config(["$interpolateProvider",function(e){e.startSymbol("{["),e.endSymbol("]}")}])}(),function(){function e(e,n,t,o,a,i,c,r,u,s,l){var h=this;h.accountInfo={},h.generateTitle={},h.getAccount=function(){e.account().then(function(e){200==e.status&&(h.accountInfo=e.data,new Date(h.accountInfo.tokenExpire)<new Date&&(h.accountInfo.accessToken=""))})},h.init=function(){h.getAccount(),n.getCampaigns().then(function(e){200==e.status?h.listCampaigns=e.data:r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},h.saveCampaign=function(e){if(!e)return void r.error("Kiểm tra lại dữ liệu và thử lại.","Lỗi!");n.saveCampaign(h.campaign).then(function(e){if(200==e.status){if(h.campaign._id){for(var n in h.listCampaigns)if(h.listCampaigns[n]._id==h.campaign._id){h.listCampaigns[n]=e.data;break}}else h.listCampaigns||(h.listCampaigns=[]),h.listCampaigns.unshift(e.data);i.CampaignForm.$setPristine(),h.campaign=e.data,r.success("Lưu chiến dịch thành công.","Thành công!")}else r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},h.removeCampaign=function(e,t){confirm("Bạn có chắc chắn muốn xóa?")&&n.removeCampaign(e).then(function(e){200==e.status&&e.data?(r.success("Xóa chiến dịch thành công.","Thành công!"),h.listCampaigns.splice(t,1),h.resetCampaign()):r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},h.runCampaign=function(e){confirm("Bạn chắc chắn muốn chạy chiến dịch này?")&&n.runCampaign(e).then(function(e){200==e.status&&e.data?r.success(e.data.msg,"Thành công!"):r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){r.error(e.data.message,"Lỗi!")})},h.selectCampaign=function(e){h.campaign=e,Common.scrollTo("#campaign-top","fast"),h.postTypeChange(),h.filterTimeline()},h.resetCampaign=function(){h.campaign={}},h.postTypeChange=function(){"feed"==h.campaign.postType?t.getFeeds().then(function(e){200==e.status?h.listFeeds=e.data:r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}):o.getAlbums().then(function(e){200==e.status?h.listAlbums=e.data:r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){r.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},h.filterTimeline=function(){h.timelineList=h.accountInfo.timelineId.filter(function(e){return h.campaign.timeline?e.type==h.campaign.timeline?e:void 0:e})}}e.$inject=["UserService","CampaignService","FeedService","AlbumService","$cookies","$scope","$rootScope","toastr","$timeout","$facebook","$http"],angular.module("Campaign").controller("CampaignController",e)}(),function(){function e(e){return{getCampaigns:function(){return e.get(apiPath+"/api/campaign/getCampaigns")},saveCampaign:function(n){return e.post(apiPath+"/api/campaign/saveCampaign",n)},removeCampaign:function(n){return e.post(apiPath+"/api/campaign/removeCampaign",{campaignId:n})},runCampaign:function(n){return e.post(apiPath+"/api/campaign/runCampaign",{campaignId:n})},stopCampaign:function(n){return e.post(apiPath+"/api/campaign/stopCampaign",{campaignId:n})}}}e.$inject=["$http"],angular.module("Campaign").service("CampaignService",e)}();var Common=function(){return{scrollTo:function(e,n){e=e||"html,body",n=n||"slow",$("html,body").animate({scrollTop:$(e).offset().top},n)}}}();!function(){angular.module("Core",[]).config(["$interpolateProvider",function(e){e.startSymbol("{["),e.endSymbol("]}")}])}(),function(){function e(){return{restrict:"AE",templateUrl:"modules/web-core/views/js/template/error-message.html",replace:!0,scope:{errorMessage:"=",matchTarget:"=",typeContent:"=",stepValue:"="},link:function(e,n,t){function o(){e.typeContent&&e.matchTarget&&e.typeContent!=e.matchTarget?e.errorMessage.match=!0:e.errorMessage.match=!1}e.$watch("typeContent",function(e){o()}),e.$watch("matchTarget",function(e){o()})}}}function n(){return{restrict:"A",scope:{showLoading:"="},link:function(e,n,t){e.$watch("showLoading",function(e){e&&$(n).fadeIn("fast")})}}}angular.module("Core").directive("errorMessage",e).directive("showLoading",n)}(),function(){function e(){return function(e,n){return n=n||50,e&&e.length>n?e.substr(0,n)+"...":e}}angular.module("Core").filter("shortString",e)}(),function(){function e(e,n,t){return{response:function(n){return 200==n.status&&(n.data.noAccessToken&&e.$broadcast("NO_ACCESS_TOKEN_ERROR"),n.data.tokenHasExpired&&e.$broadcast("TOKEN_HAS_EXPIRED_ERROR"),n.data.rejectApi)?t.reject({status:!1,data:{message:"You have access token!"},handle:"PreResponse"}):n}}}e.$inject=["$rootScope","$timeout","$q"],angular.module("Core").factory("PreResponse",e).config(["$httpProvider",function(e){e.interceptors.push("PreResponse")}])}(),function(){angular.module("Feed",[]).config(["$interpolateProvider",function(e){e.startSymbol("{["),e.endSymbol("]}")}])}(),function(){function e(e,n,t,o,a,i,c,r){var u=this;u.accountInfo={},u.getAccount=function(){e.account().then(function(e){200==e.status&&(u.accountInfo=e.data,new Date(u.accountInfo.tokenExpire)<new Date&&(u.accountInfo.accessToken=""))})},u.init=function(){u.getAccount(),n.getFeeds().then(function(e){200==e.status?u.listFeeds=e.data:a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},u.saveFeed=function(e){if(!e)return void a.error("Kiểm tra lại dữ liệu và thử lại.","Lỗi!");n.saveFeed(u.feed).then(function(e){if(200==e.status){if(u.feed._id){for(var n in u.listFeeds)if(u.listFeeds[n]._id==u.feed._id){u.listFeeds[n]=e.data;break}}else u.listFeeds||(u.listFeeds=[]),u.listFeeds.unshift(e.data);u.feed=e.data,a.success("Lưu trạng thái thành công.","Thành công!")}else a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},u.removeFeed=function(e,t){confirm("Bạn có chắc chắn muốn xóa?")&&n.removeFeed(e).then(function(e){200==e.status&&e.data?(a.success("Xóa trạng thái thành công.","Thành công!"),u.listFeeds.splice(t,1),u.resetFeed()):a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){a.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},u.selectFeed=function(e){u.feed=e,Common.scrollTo("#feed-top","fast")},u.resetFeed=function(){u.feed={}}}e.$inject=["UserService","FeedService","$cookies","$rootScope","toastr","$timeout","$facebook","$http"],angular.module("Feed").controller("FeedController",e)}(),function(){function e(e){return{getFeeds:function(){return e.get(apiPath+"/api/feed/getFeeds")},saveFeed:function(n){return e.post(apiPath+"/api/feed/saveFeed",n)},removeFeed:function(n){return e.post(apiPath+"/api/feed/removeFeed",{feedId:n})}}}e.$inject=["$http"],angular.module("Feed").service("FeedService",e)}(),function(){angular.module("Graph",[]).config(["$interpolateProvider",function(e){e.startSymbol("{["),e.endSymbol("]}")}])}(),function(){function e(e,n,t,o,a,i,c,r,u,s,l){var h=this;h.accountInfo={},h.getAccount=function(){e.account().then(function(e){200==e.status&&(h.accountInfo=e.data,new Date(h.accountInfo.tokenExpire)<new Date&&(h.accountInfo.accessToken=""))})},h.init=function(){h.getAccount(),n.getFeeds().then(function(e){200==e.status?h.listFeeds=e.data:c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}),o.getAlbums().then(function(e){200==e.status?h.listAlbums=e.data:c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},h.postPhotoToAlbum=function(){var e=[];h.albumId.photos.map(function(n){e.push(function(e){console.log("ss",l.settings.services.webUrl+"/files/albums/"+h.albumId._id+"/"+n),t.graphApi(h.accountInfo.accessToken,"post","/"+h.createdAlbumId+"/photos",{url:"https://www.w3schools.com/css/img_fjords.jpg"}).then(function(n){200==n.status?e(null,n.data):e(!0)}).catch(function(){e(!0)})})}),async.parallel(e,function(e,n){e?(console.log("POST PHOTO",e),c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")):c.success("Đăng hình ảnh lên album thành công.","Thành công!")})},h.postGroup=function(e){if(!e)return void c.error("Kiểm tra lại dữ liệu và thử lại sau.","Lỗi!");var n;0==h.postType?n=t.graphApi(h.accountInfo.accessToken,"post","/"+h.groupId+"/feed",{message:h.feedId.message}):1==h.postType&&(n=t.graphApi(h.accountInfo.accessToken,"post","/"+h.groupId+"/albums",{name:h.albumId.name,message:h.albumId.message})),n.then(function(e){200==e.status?(console.log("Post group data:",e.data),c.success("Đã đăng lên nhóm thành công.","Thành công!"),1==h.postType&&(h.createdAlbumId=e.data.id,h.createdAlbumId&&h.postPhotoToAlbum())):c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){console.log("Err",e),c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})}}e.$inject=["UserService","FeedService","GraphService","AlbumService","$cookies","$rootScope","toastr","$timeout","$facebook","$http","$window"],angular.module("Graph").controller("GraphController",e)}(),function(){function e(e){return{graphApi:function(n,t,o,a){return t=t?t.toLowerCase():"get",t="get"==t?t:"post",a||(a={}),a.accessToken=n,a.apiUrl=o,a.method=t,e.post(apiPath+"/api/user/graphApi",a)}}}e.$inject=["$http"],angular.module("Graph").service("GraphService",e)}(),function(){angular.module("Schedule",[]).config(["$interpolateProvider",function(e){e.startSymbol("{["),e.endSymbol("]}")}])}(),function(){function e(e,n,t,o,a,i,c,r,u,s){var l=this;l.accountInfo={},l.schedule={},l.schedule.endTimeNumber=3,l.dateOptions={minDate:new Date((new Date).getTime()+36e5),maxDate:new Date((new Date).getTime()+9e7),sideBySide:!0},l.getAccount=function(){e.account().then(function(e){200==e.status&&(l.accountInfo=e.data,new Date(l.accountInfo.tokenExpire)<new Date&&(l.accountInfo.accessToken=""))})},l.init=function(){l.getAccount(),t.getSchedules().then(function(e){200==e.status?l.listSchedules=e.data:c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}),n.getCampaigns().then(function(e){200==e.status?l.listCampaigns=e.data:c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(){c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},l.saveSchedule=function(e){if(!e)return void c.error("Kiểm tra lại dữ liệu và thử lại.","Lỗi!");t.saveSchedule(l.schedule).then(function(e){if(200==e.status){if(l.schedule._id){for(var n in l.listSchedules)if(l.listSchedules[n]._id==l.schedule._id){l.listSchedules[n]=e.data;break}}else l.listSchedules||(l.listSchedules=[]),l.listSchedules.unshift(e.data),l.selectScheduleIndex=0;l.schedule=e.data,r(function(){a.ScheduleForm.$setPristine()},500),c.success("Lưu trạng thái thành công.","Thành công!")}else c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},l.removeSchedule=function(e,n){confirm("Bạn có chắc chắn muốn xóa?")&&t.removeSchedule(e).then(function(e){200==e.status&&e.data?(c.success("Xóa trạng thái thành công.","Thành công!"),l.listSchedules.splice(n,1),l.resetSchedule()):c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")}).catch(function(e){c.error("Có lỗi xảy ra, thử lại sau.","Lỗi!")})},l.selectSchedule=function(e,n){l.selectScheduleIndex=n,l.schedule=e,Common.scrollTo("#schedule-top","fast"),r(function(){a.ScheduleForm.$setPristine()},500)},l.resetSchedule=function(){l.schedule={}},l.runSchedule=function(e,n){confirm("Bạn có chắc chắn chạy lịch trình này?")&&(n=n||l.selectScheduleIndex,t.runSchedule(e).then(function(e){200==e.status?(l.listSchedules[n]=e.data.data,l.schedule=e.data.data,c.success(e.data.msg,"Thành công!")):c.error("Có lỗi xảy ra, vui lòng thử lại sau.","Lỗi!")}).catch(function(e){c.error(e.message,"Lỗi!")}))},l.stopSchedule=function(e,n){confirm("Bạn có chắc chắn dừng lịch trình này?")&&(n=n||l.selectScheduleIndex,t.stopSchedule(e).then(function(e){200==e.status?(l.listSchedules[n]=e.data.data,l.schedule=e.data.data,c.success(e.data.msg,"Thành công!")):c.error("Có lỗi xảy ra, vui lòng thử lại sau.","Lỗi!")}).catch(function(e){c.error(e.message,"Lỗi!")}))},l.changeCampaign=function(){l.campaignDescription="Không có mô tả";for(var e in l.listCampaigns)if(l.listCampaigns[e]._id==l.schedule.campaignId){l.campaignDescription=l.listCampaigns[e].description||"Không có mô tả";break}$('[data-toggle="popover"]').popover()}}e.$inject=["UserService","CampaignService","ScheduleService","$cookies","$scope","$rootScope","toastr","$timeout","$facebook","$http"],angular.module("Schedule").controller("ScheduleController",e)}(),function(){function e(e){return{getSchedules:function(){return e.get(apiPath+"/api/schedule/getSchedules")},saveSchedule:function(n){return e.post(apiPath+"/api/schedule/saveSchedule",n)},removeSchedule:function(n){return e.post(apiPath+"/api/schedule/removeSchedule",{scheduleId:n})},runSchedule:function(n){return e.post(apiPath+"/api/schedule/runSchedule",{scheduleId:n})},stopSchedule:function(n){return e.post(apiPath+"/api/schedule/stopSchedule",{scheduleId:n})}}}e.$inject=["$http"],angular.module("Schedule").service("ScheduleService",e)}(),function(){angular.module("User",[]).config(["$interpolateProvider",function(e){e.startSymbol("{["),e.endSymbol("]}")}])}(),function(){function e(e,n,t,o,a,i,c){function r(t,i,c){e.update(t).then(function(e){console.log("Resp",e),c=c||"Cập nhật tài khoản thành công.",i&&(c+=" Đang làm mới trang."),o.success("Cập nhật tài khoản thành công!","Thông báo!"),e.data.appId&&n.put("appId",e.data.appId,{path:"/"}),i&&a(function(){window.location.reload()},2e3)}).catch(function(e){var n=e.data;o.error(n.message||n,"Thông báo!")})}var u=this;u.accountInfo={},u.showLoading=!1,u.showApiError=function(e){-1==window.location.href.search("/trang-ca-nhan")&&-1==window.location.href.search("/trang/")&&-1==window.location.href.search("/tro-giup")&&(o.error(e,"Lỗi"),a(function(){window.location.href=window.settings.services.webUrl+"/trang-ca-nhan"},2e3))},t.$on("NO_ACCESS_TOKEN_ERROR",function(){u.showApiError("Bạn chưa có mã truy cập, hãy đến trang cá nhân, bổ sung thông tin và nhận mã truy cập.")}),t.$on("TOKEN_HAS_EXPIRED_ERROR",function(){u.showApiError("Mã truy cập đã hết hạn, hãy đến trang cá nhân và cập nhật mã truy cập.")}),u.getAccount=function(){e.account().then(function(e){200==e.status&&(u.accountInfo=e.data,e.data.appId&&e.data.appSecret&&(u.appIdValid=!0),new Date(u.accountInfo.tokenExpire)<new Date&&(u.accountInfo.accessToken=""),u.accountInfo.includes("admin")&&(u.accountInfo.isAdmin=!0),u.showLoading=!0)}).catch(function(){u.showLoading=!0})},u.getAccount(),u.login=function(t){if(!t)return void o.error("Kiểm tra lại dữ liệu và thử lại.","Lỗi!");e.login({email:u.form.email,password:u.form.password}).then(function(e){console.log("Resp",e),n.put("token",e.data.token,{path:"/"}),n.put("appId",e.data.appId,{path:"/"}),window.location.reload()})},u.logout=function(){e.logout().then(function(e){n.remove("token"),window.location.reload()}).catch(function(e){n.remove("token"),window.location.reload()})},u.register=function(n){if(!n)return void o.error("Kiểm tra lại thông tin đã nhập.","Lỗi!");e.register({email:u.form.email,password:u.form.password,name:u.form.name}).then(function(e){console.log("Resp",e),o.success("Đăng ký tài khoản thành công!","Thông báo!"),a(function(){u.login(!0)},2e3)}).catch(function(e){var n=e.data;o.error(n.message||n,"Thông báo!")})},u.update=function(e){if(!e)return void o.error("Kiểm tra lại thông tin đã nhập.","Lỗi!");r({name:u.accountInfo.name,appId:u.accountInfo.appId,timelineId:u.accountInfo.timelineId,accessToken:u.accountInfo.accessToken,appSecret:u.accountInfo.appSecret,tokenExpire:u.accountInfo.tokenExpire,removeAccessToken:!u.appIdValid},!0)},u.getAccessToken=function(){i.login().then(function(e){console.log("getAccessToken",e),e.authResponse&&e.authResponse.accessToken&&(u.accountInfo.timelineId.unshift({type:"personal",id:e.authResponse.userID,name:"Dòng thời gian cá nhân"}),u.extendToken(e.authResponse.accessToken))})},u.extendToken=function(n){e.extendAccessToken({accessToken:n,appId:u.accountInfo.appId,appSecret:u.accountInfo.appSecret}).then(function(e){200==e.status&&(u.accountInfo.accessToken=e.data.access_token,u.accountInfo.tokenExpire=new Date((new Date).getTime()+1e3*e.data.expires_in),u.update(!0))})},u.getTimelineInfo=function(e,n){if(!e||!n)return void o.error("Nhập từ khóa tìm kiếm và chọn 1 loại dòng thời gian","Lỗi");u.isLoading=!0,i.api("/search?q="+e+"&type="+n+"&access_token="+u.accountInfo.accessToken).then(function(e){console.log("get group info",e),e.data&&e.data.length?u.listTimelines=e.data:o.error("Không lấy được thông tin.","Lỗi!"),u.isLoading=!1},function(e){console.log("timeline info",e),u.isLoading=!1})},u.removeTimeline=function(e){confirm("Bạn có chắc chắn muốn xóa?")&&(u.accountInfo.timelineId.splice(e,1),r({timelineId:u.accountInfo.timelineId},!1,"Đã cập nhật danh sách nhóm thành công."))},u.resetAccessToken=function(){u.appIdValid=!1,u.accountInfo.accessToken=null,u.accountInfo.tokenExpire=null},u.resetListTimeline=function(){u.listTimelines=[]},u.addTimeline=function(e){var n=e,t=!1;for(var o in u.accountInfo.timelineId){var a=u.accountInfo.timelineId[o];if(n.id==a.id){t=!0;break}}t||u.accountInfo.timelineId.unshift({type:u.timelineType,id:n.id,name:n.name}),e.disableClass="disabled",r({timelineId:u.accountInfo.timelineId},!1,"Đã cập nhật danh sách nhóm thành công.")}}e.$inject=["UserService","$cookies","$rootScope","toastr","$timeout","$facebook","$http"],angular.module("User").controller("UserController",e)}(),function(){function e(e){var n;return{login:function(n){return e({method:"POST",url:apiPath+"/api/user/login",data:n})},logout:function(n){return e({method:"GET",url:apiPath+"/api/user/logout"})},account:function(t){return n||(n=e({method:"GET",url:apiPath+"/api/user/account"})),n},register:function(n){return e({method:"POST",url:apiPath+"/api/user/register",data:n})},update:function(n){return e({method:"POST",url:apiPath+"/api/user/update",data:n})},extendAccessToken:function(n){return e({method:"POST",url:apiPath+"/api/user/extendAccessToken",data:n})}}}e.$inject=["$http"],angular.module("User").service("UserService",e)}();var apiPath=window.location.origin;window.location.port&&(apiPath=window.settings.services.apiUrl),function(){var e=["User","Core","Feed","Graph","Album","Campaign","Schedule","ngCookies","ngAnimate","toastr","angular-loading-bar","ngMessages","ngFacebook","ngFileUpload","ae-datetimepicker"];angular.module("HapiApp",e).config(["$httpProvider","$facebookProvider",function(e,n){e.defaults.withCredentials=!0,window.appId&&(n.setAppId(window.appId),n.setPermissions("email,publish_actions,user_managed_groups,user_photos"))}]).run(["$window",function(e){window.appId&&function(){if(!document.getElementById("facebook-jssdk")){var e=document.getElementsByTagName("script")[0],n=document.createElement("script");n.id="facebook-jssdk",n.src="//connect.facebook.net/en_US/all.js",e.parentNode.insertBefore(n,e)}}()}]).config(["$locationProvider",function(e){e.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}])}();